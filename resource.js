var{createCanvas:crc, CanvasPattern, loadImage, Image}=require("canvas"),prot=crc(1,1).getContext("2d").__proto__,fll=prot.fill,setfm=prot.setTransform,rsetfm=prot.resetTransform,drimg=prot.drawImage,gimd=prot.getImageData,pimd=prot.putImageData;prot.getImageData=function(x,y,w,h){return gimd.call(this,x+this.canvas.w/2,y+this.canvas.h/2,w,h)};prot.putImageData=function(i,dx,dy){return pimd.call(this,i,(dx||0)+this.canvas.w/2,(dy||0)+this.canvas.h/2)};prot.fill=function(a){fll.call(this,a);this.strokeStyle=this.fillStyle;var k=this.lineWidth,kk=this.globalAlpha,kkk=this.globalCompositeOperation;this.lineWidth=20;this.globalAlpha=0.6;this.globalCompositeOperation='soft-light';this.stroke();this.globalCompositeOperation=kkk;this.globalAlpha=kk;this.lineWidth=k};prot.resetTransform=function(){this.setTransform(1,0,0,1,0,0)};prot.setTransform=function(a,b,c,d,e,f){setfm.call(this,a,b,c,d,e+this.canvas.w/2,f+this.canvas.h/2)};prot.drawImage=function(...i){if(i[0] instanceof Image)return drimg.apply(this,i);let l=i.length>5&&5||1;drimg.call(this,i[0],i.length>5&&i[1]||0,i.length>5&&i[2]||0,i[0].w*2+(i.length>5&&(i[3]-i[0].w/2)||0),i[0].h*2+(i.length>5&&(i[4]-i[0].h/2)||0),i[l]-i[0].w/2,i[l+1]-i[0].h/2,i[0].w+(i[l+2]||i[0].w),i[0].h+(i[l+3]||i[0].h))};var createCanvas=function(w,h){w=w*2;h=h*2;var c=crc(w,h),a=c.getContext('2d');a.translate(w/4,h/4);Object.defineProperties(c, {w:{get:()=>c.width/2,set:x=>{c.width=x*2}},h:{get:()=>c.height/2,set:x=>{c.height=x*2}}});return c},fs=require("fs"),Filters={_premultiply:function(t){for(var a=t.length,e=0;e<a;e+=4){var r=.003921569*t[e+3];t[e]=Math.round(t[e]*r),t[e+1]=Math.round(t[e+1]*r),t[e+2]=Math.round(t[e+2]*r)}},_unpremultiply:function(t){for(var a=t.length,e=0;e<a;e+=4){var r=t[e+3];if(0!=r&&255!=r){var i=255/r,n=t[e]*i,o=t[e+1]*i,s=t[e+2]*i;n>255&&(n=255),o>255&&(o=255),s>255&&(s=255),t[e]=n,t[e+1]=o,t[e+2]=s}}},_boxBlurHorizontal:function(t,a,e,r,i,n){for(var o=0,s=[],h=0;h<r;h++){for(var d=0,l=0,c=0,u=0,g=0,m=4*-i;m<4*e;m+=4){var f=m-4*i-4;f>=0&&(0==n||1==n&&a[o+f+3]>0||2==n&&a[o+f+3]<255)&&(g-=t[o+f+3],l-=t[o+f],c-=t[o+f+1],u-=t[o+f+2],d--);var v=m+4*i;v<4*e&&(0==n||1==n&&a[o+v+3]>0||2==n&&a[o+v+3]<255)&&(g+=t[o+v+3],l+=t[o+v],c+=t[o+v+1],u+=t[o+v+2],d++),m>=0&&(0==n||1==n&&a[o+m+3]>0||2==n&&a[o+m+3]<255?0==d?(s[m]=0,s[m+1]=0,s[m+2]=0,s[m+3]=0):(s[m]=Math.round(l/d),s[m+1]=Math.round(c/d),s[m+2]=Math.round(u/d),s[m+3]=Math.round(g/d)):(s[m]=0,s[m+1]=0,s[m+2]=0,s[m+3]=0))}for(var _=0;_<4*e;_+=4)t[o+_]=s[_],t[o+_+1]=s[_+1],t[o+_+2]=s[_+2],t[o+_+3]=s[_+3];o+=4*e}},_boxBlurVertical:function(t,a,e,r,i,n){for(var o=[],s=-(i+1)*e*4,h=i*e*4,d=0;d<4*e;d+=4){for(var l=0,c=0,u=0,g=0,m=0,f=-i*e*4+d,v=-i;v<r;v++){v-i-1>=0&&(0==n||1==n&&a[f+s+3]>0||2==n&&a[f+s+3]<255)&&(m-=t[f+s+3],c-=t[f+s],u-=t[f+s+1],g-=t[f+s+2],l--),v+i<r&&(0==n||1==n&&a[f+h+3]>0||2==n&&a[f+h+3]<255)&&(m+=t[f+h+3],c+=t[f+h],u+=t[f+h+1],g+=t[f+h+2],l++),v>=0&&(0==n||1==n&&a[v*e*4+d+3]>0||2==n&&a[v*e*4+d+3]<255?0==l?(o[4*v]=0,o[4*v+1]=0,o[4*v+2]=0,o[4*v+3]=0):(o[4*v]=Math.round(c/l),o[4*v+1]=Math.round(u/l),o[4*v+2]=Math.round(g/l),o[4*v+3]=Math.round(m/l)):(o[4*v]=0,o[4*v+1]=0,o[4*v+2]=0,o[4*v+3]=0)),f+=4*e}for(v=0;v<r;v++)t[v*e*4+d]=o[4*v],t[v*e*4+d+1]=o[4*v+1],t[v*e*4+d+2]=o[4*v+2],t[v*e*4+d+3]=o[4*v+3]}},blur:function(t,a,e,r,i,n,o){var s=a.getImageData(0,0,t.w,t.h),h=s.data;Filters._premultiply(h);for(var d=0;d<i;d++)Filters._boxBlurHorizontal(h,n,t.w,t.h,Math.floor(e/2),o),Filters._boxBlurVertical(h,n,t.w,t.h,Math.floor(r/2),o);Filters._unpremultiply(h);var l=t.w,c=t.h,u=createCanvas(l,c);return u.getContext("2d").putImageData(s,0,0),u},_moveRGB:function(t,a,e,r,i,n){var o=createCanvas(t,a),s=o.getContext("2d");Filters._setRGB(s,0,0,t,a,e);var h=createCanvas(t,a);h.w=t,h.heigth=a;var d=h.getContext("2d");return d.fillStyle=n,d.globalCompositeOperation="copy",d.fillRect(0,0,t,a),d.drawImage(o,r,i),d.getImageData(0,0,t,a).data},FULL:1,INNER:2,OUTER:3,_setRGB:function(t,a,e,r,i,n){for(var o=t.createImageData(r,i),s=0;s<n.length;s++)o.data[s]=n[s];t.putImageData(o,a,e)},gradientGlow:function(t,a,e,r,i,n,o,s,h,d,l,c){for(var u=canvas.w,g=canvas.h,m=createCanvas(u,g),f=m.getContext("2d"),v=createCanvas(256,1),_=v.getContext("2d"),M=ctx.createLinearGradient(0,0,255,0),p=0;p<o.length;p++){var x="rgba("+o[p][0]+","+o[p][1]+","+o[p][2]+","+o[p][3]+")";M.addColorStop(s[p],x)}_.fillStyle=M,_.fillRect(0,0,256,1);for(var C=_.getImageData(0,0,v.w,v.h).data,b=i/180*Math.PI,w=n*Math.cos(b),I=n*Math.sin(b),R=a.getImageData(0,0,u,g).data,y=[],B=0;B<R.length;B+=4){var T=R[B+3];y[B]=0,y[B+1]=0,y[B+2]=0,y[B+3]=Math.round(T*l)}y=Filters._moveRGB(u,g,y,w,I,"rgba(0,0,0,0)"),Filters._setRGB(f,0,0,u,g,y);var F=0;if(h==Filters.INNER&&(F=1),h==Filters.OUTER&&(F=2),y=(f=(m=Filters.blur(m,m.getContext("2d"),e,r,d,R,F)).getContext("2d")).getImageData(0,0,u,g).data,0!=F)for(B=0;B<R.length;B+=4)(1==F&&0==R[B+3]||2==F&&255==R[B+3])&&(y[B]=0,y[B+1]=0,y[B+2]=0,y[B+3]=0);for(B=0;B<y.length;B+=4){var D=y[B+3];y[B]=C[4*D],y[B+1]=C[4*D+1],y[B+2]=C[4*D+2],y[B+3]=C[4*D+3]}return Filters._setRGB(f,0,0,u,g,y),c||(f.globalCompositeOperation="destination-over",f.drawImage(t,0,0)),m},dropShadow:function(t,a,e,r,i,n,o,s,h,d,l){for(var c=t.w,u=t.h,g=a.getImageData(0,0,c,u).data,m=[],f=0;f<g.length;f+=4){var v=g[f+3];s&&(v=255-v),m[f]=o[0],m[f+1]=o[1],m[f+2]=o[2];var _=o[3]*v*d;_>255&&(_=255),m[f+3]=Math.round(_)}var M=i/180*Math.PI,p=n*Math.cos(M),x=n*Math.sin(M);m=Filters._moveRGB(c,u,m,p,x,s?"#000000":"rgba(0,0,0,0)");var C=createCanvas(t.w,t.h);Filters._setRGB(C.getContext("2d"),0,0,c,u,m),(e>0||r>0)&&(C=Filters.blur(C,C.getContext("2d"),e,r,h,null,0)),m=C.getContext("2d").getImageData(0,0,c,u).data;for(g=a.getImageData(0,0,c,u).data,f=0;f<m.length;f+=4){var b=g[f+3];s||(b=255-b),m[f+3]=b*m[f+3]/255}if(Filters._setRGB(C.getContext("2d"),0,0,c,u,m),!l){var w=C.getContext("2d");w.globalCompositeOperation="destination-over",w.drawImage(t,0,0)}return C},_cut:function(t,a,e){return t>e&&(t=e),t<a&&(t=a),t},gradientBevel:function(t,a,e,r,i,n,o,s,h,d,l,c){for(var u=t.w,g=t.h,m=createCanvas(u,g),f=a.getImageData(0,0,u,g).data,v=createCanvas(512,1),_=v.getContext("2d"),M=ctx.createLinearGradient(0,0,511,0),p=0;p<e.length;p++){var x="rgba("+e[p][0]+","+e[p][1]+","+e[p][2]+","+e[p][3]+")";M.addColorStop(r[p],x)}_.fillStyle=M,_.globalCompositeOperation="copy",_.fillRect(0,0,v.w,v.h);var C=_.getImageData(0,0,v.w,v.h).data;if(s!=Filters.OUTER){var b=Filters.dropShadow(t,a,0,0,h,d,[255,0,0,1],!0,c,o,!0),w=Filters.dropShadow(t,a,0,0,h+180,d,[0,0,255,1],!0,c,o,!0),I=createCanvas(u,g),R=createCanvas(u,g),y=I.getContext("2d"),B=R.getContext("2d");y.drawImage(b,0,0),y.globalCompositeOperation="destination-out",y.drawImage(w,0,0),B.drawImage(w,0,0),B.globalCompositeOperation="destination-out",B.drawImage(b,0,0);var T=R,F=I}if(s!=Filters.INNER){var b=Filters.dropShadow(t,a,0,0,h+180,d,[255,0,0,1],!1,c,o,!0),w=Filters.dropShadow(t,a,0,0,h,d,[0,0,255,1],!1,c,o,!0);I=createCanvas(u,g),R=createCanvas(u,g),y=I.getContext("2d"),B=R.getContext("2d");y.drawImage(b,0,0),y.globalCompositeOperation="destination-out",y.drawImage(w,0,0),B.drawImage(w,0,0),B.globalCompositeOperation="destination-out",B.drawImage(b,0,0);var D=R,O=I}switch(s){case Filters.OUTER:b=O,w=D;break;case Filters.INNER:b=F,w=T;break;case Filters.FULL:w=T,(y=(b=F).getContext("2d")).globalCompositeOperation="source-over",y.drawImage(O,0,0),(B=w.getContext("2d")).globalCompositeOperation="source-over",B.drawImage(D,0,0)}var k=0;s==Filters.INNER&&(k=1),s==Filters.OUTER&&(k=2);var L=m.getContext("2d");L.fillStyle="#000000",L.fillRect(0,0,u,g),L.drawImage(w,0,0),L.drawImage(b,0,0);for(var N=(m=Filters.blur(m,m.getContext("2d"),i,n,c,f,k)).getContext("2d").getImageData(0,0,u,g).data,E=0;E<f.length;E+=4){var G=N[E]*o,P=N[E+2]*o,S=Filters._cut(G-P,-255,255);N[E]=C[4*(255+S)],N[E+1]=C[4*(255+S)+1],N[E+2]=C[4*(255+S)+2],N[E+3]=C[4*(255+S)+3]}if(Filters._setRGB(m.getContext("2d"),0,0,u,g,N),!l){var q=m.getContext("2d");q.globalCompositeOperation="destination-over",q.drawImage(t,0,0)}return m},bevel:function(t,a,e,r,i,n,o,s,h,d,l,c){return Filters.gradientBevel(t,a,[s,[s[0],s[1],s[2],0],[o[0],o[1],o[2],0],o],[0,127/255,128/255,1],e,r,i,n,h,d,l,c)},convolution:function(t,a,e,r){for(var i=a.getImageData(0,0,t.w,t.h),n=Math.round(Math.sqrt(e.length)),o=Math.floor(n/2),s=i.data,h=i.w,d=i.h,l=h,c=d,u=createCanvas(l,c),g=u.getContext("2d"),m=g.getImageData(0,0,l,c),f=m.data,v=r?1:0,_=0;_<c;_++)for(var M=0;M<l;M++){for(var p=_,x=M,C=4*(_*l+M),b=0,w=0,I=0,R=0,y=0;y<n;y++)for(var B=0;B<n;B++){var T=p+y-o,F=x+B-o;if(T>=0&&T<d&&F>=0&&F<h){var D=4*(T*h+F),O=e[y*n+B];b+=s[D]*O,w+=s[D+1]*O,I+=s[D+2]*O,R+=s[D+3]*O}}f[C]=b,f[C+1]=w,f[C+2]=I,f[C+3]=R+v*(255-R)}return g.putImageData(m,0,0),u},colorMatrix:function(t,a,e){for(var r=a.getImageData(0,0,t.w,t.h),i=r.data,n=0;n<i.length;n+=4){var o=n,s=n+1,h=n+2,d=n+3,l=i[o],c=i[s],u=i[h],g=i[d];i[o]=e[0]*l+e[1]*c+e[2]*u+e[3]*g+e[4],i[s]=e[5]*l+e[6]*c+e[7]*u+e[8]*g+e[9],i[h]=e[10]*l+e[11]*c+e[12]*u+e[13]*g+e[14],i[d]=e[15]*l+e[16]*c+e[17]*u+e[18]*g+e[19]}var m=createCanvas(t.w,t.h);return m.getContext("2d").putImageData(r,0,0),m},glow:function(t,a,e,r,i,n,o,s,h){return Filters.dropShadow(t,a,e,r,45,0,n,o,h,i,s)}},BlendModes={_cut:function(t){return t<0&&(t=0),t>255&&(t=255),t},normal:function(t,a,e,r){var i=(255-t[r+3])/255;e[r]=this._cut(t[r]*t[r+3]/255+a[r]*a[r+3]/255*i),e[r+1]=this._cut(t[r+1]*t[r+3]/255+a[r+1]*a[r+3]/255*i),e[r+2]=this._cut(t[r+2]*t[r+3]/255+a[r+2]*a[r+3]/255*i),e[r+3]=this._cut(t[r+3]+a[r+3]*i)},layer:function(t,a,e,r){BlendModes.normal(t,a,e,r)},multiply:function(t,a,e,r){e[r+0]=t[r+0]*a[r+0]>>8,e[r+1]=t[r+1]*a[r+1]>>8,e[r+2]=t[r+2]*a[r+2]>>8,e[r+3]=Math.min(255,t[r+3]+a[r+3]-t[r+3]*a[r+3]/255)},screen:function(t,a,e,r){e[r+0]=255-((255-t[r+0])*(255-a[r+0])>>8),e[r+1]=255-((255-t[r+1])*(255-a[r+1])>>8),e[r+2]=255-((255-t[r+2])*(255-a[r+2])>>8),e[r+3]=Math.min(255,t[r+3]+a[r+3]-t[r+3]*a[r+3]/255)},lighten:function(t,a,e,r){e[r+0]=Math.max(t[r+0],a[r+0]),e[r+1]=Math.max(t[r+1],a[r+1]),e[r+2]=Math.max(t[r+2],a[r+2]),e[r+3]=Math.min(255,t[r+3]+a[r+3]-t[r+3]*a[r+3]/255)},darken:function(t,a,e,r){e[r+0]=Math.min(t[r+0],a[r+0]),e[r+1]=Math.min(t[r+1],a[r+1]),e[r+2]=Math.min(t[r+2],a[r+2]),e[r+3]=Math.min(255,t[r+3]+a[r+3]-t[r+3]*a[r+3]/255)},difference:function(t,a,e,r){e[r+0]=Math.abs(a[r+0]-t[r+0]),e[r+1]=Math.abs(a[r+1]-t[r+1]),e[r+2]=Math.abs(a[r+2]-t[r+2]),e[r+3]=Math.min(255,t[r+3]+a[r+3]-t[r+3]*a[r+3]/255)},add:function(t,a,e,r){e[r+0]=Math.min(255,t[r+0]+a[r+0]),e[r+1]=Math.min(255,t[r+1]+a[r+1]),e[r+2]=Math.min(255,t[r+2]+a[r+2]),e[r+3]=Math.min(255,t[r+3]+a[r+3])},subtract:function(t,a,e,r){e[r+0]=Math.max(0,t[r+0]+a[r+0]-256),e[r+1]=Math.max(0,t[r+1]+a[r+1]-256),e[r+2]=Math.max(0,t[r+2]+a[r+2]-256),e[r+3]=Math.min(255,t[r+3]+a[r+3]-t[r+3]*a[r+3]/255)},invert:function(t,a,e,r){e[r+0]=255-a[r+0],e[r+1]=255-a[r+1],e[r+2]=255-a[r+2],e[r+3]=t[r+3]},alpha:function(t,a,e,r){e[r+0]=t[r+0],e[r+1]=t[r+1],e[r+2]=t[r+2],e[r+3]=a[r+3]},erase:function(t,a,e,r){e[r+0]=t[r+0],e[r+1]=t[r+1],e[r+2]=t[r+2],e[r+3]=255-a[r+3]},overlay:function(t,a,e,r){e[r+0]=a[r+0]<128?a[r+0]*t[r+0]>>7:255-((255-a[r+0])*(255-t[r+0])>>7),e[r+1]=a[r+1]<128?a[r+1]*t[r+1]>>7:255-((255-a[r+1])*(255-t[r+1])>>7),e[r+2]=a[r+2]<128?a[r+2]*t[r+2]>>7:255-((255-a[r+2])*(255-t[r+2])>>7),e[r+3]=Math.min(255,t[r+3]+a[r+3]-t[r+3]*a[r+3]/255)},hardlight:function(t,a,e,r){e[r+0]=t[r+0]<128?a[r+0]*t[r+0]>>7:255-((255-t[r+0])*(255-a[r+0])>>7),e[r+1]=t[r+1]<128?a[r+1]*t[r+1]>>7:255-((255-t[r+1])*(255-a[r+1])>>7),e[r+2]=t[r+2]<128?a[r+2]*t[r+2]>>7:255-((255-t[r+2])*(255-a[r+2])>>7),e[r+3]=Math.min(255,t[r+3]+a[r+3]-t[r+3]*a[r+3]/255)}};BlendModes._list=[BlendModes.normal,BlendModes.normal,BlendModes.layer,BlendModes.multiply,BlendModes.screen,BlendModes.lighten,BlendModes.darken,BlendModes.difference,BlendModes.add,BlendModes.subtract,BlendModes.invert,BlendModes.alpha,BlendModes.erase,BlendModes.overlay,BlendModes.hardlight],BlendModes.blendData=function(t,a,e,r){for(var i=[],n=[],o=0;o<e.length;o+=4){this._list[r](t,a,i,o),n[o+0]=this._cut(a[o+0]+1*(i[o+0]-a[o+0])),n[o+1]=this._cut(a[o+1]+1*(i[o+1]-a[o+1])),n[o+2]=this._cut(a[o+2]+1*(i[o+2]-a[o+2])),n[o+3]=this._cut(a[o+3]+1*(i[o+3]-a[o+3]));var s=t[o+3]/255;e[o+0]=this._cut((1-s)*a[o+0]+s*n[o+0]),e[o+1]=this._cut((1-s)*a[o+1]+s*n[o+1]),e[o+2]=this._cut((1-s)*a[o+2]+s*n[o+2]),e[o+3]=this._cut((1-s)*a[o+3]+s*n[o+3])}},BlendModes.blendCanvas=function(t,a,e,r){var i=t.w,n=t.h,o=e.getContext("2d"),s=t.getContext("2d"),h=a.getContext("2d"),d=o.getImageData(0,0,i,n),l=s.getImageData(0,0,i,n),c=h.getImageData(0,0,i,n);this.blendData(l.data,c.data,d.data,r),o.putImageData(d,0,0)};var concatMatrix=function(t,a){var e=[1,0,0,1,0,0];return e[0]=a[0]*t[0]+a[2]*t[1],e[1]=a[1]*t[0]+a[3]*t[1],e[2]=a[0]*t[2]+a[2]*t[3],e[3]=a[1]*t[2]+a[3]*t[3],e[4]=a[0]*t[4]+a[2]*t[5]+a[4],e[5]=a[1]*t[4]+a[3]*t[5]+a[5],e},enhanceContext=function(t){var a=[1,0,0,1,0,0];t._matrix=a,t._savedMatrices=[a];var e=t.__proto__;return t.__proto__={save:function(){this._savedMatrices.push(this._matrix),e.save.call(this)},restore:function(){0!=this._savedMatrices.length&&(e.restore.call(this),this._matrix=this._savedMatrices.pop())},scale:function(t,a){e.scale.call(this,t,a)},rotate:function(t){e.rotate.call(this,t)},translate:function(t,a){e.translate.call(this,t,a)},transform:function(t,a,r,i,n,o){this._matrix=concatMatrix([t,a,r,i,n,o],this._matrix),e.transform.call(this,t,a,r,i,n,o)},setTransform:function(t,a,r,i,n,o){this._matrix=[t,a,r,i,n,o],e.setTransform.call(this,t,a,r,i,n,o)},resetTransform:function(){e.resetTransform.call(this)},applyTransforms:function(t){this.setTransform(t[0],t[1],t[2],t[3],t[4],t[5])},applyTransformToPoint:function(t){var a={};return a.x=this._matrix[0]*t.x+this._matrix[2]*t.y+this._matrix[4],a.y=this._matrix[1]*t.x+this._matrix[3]*t.y+this._matrix[5],a},__proto__:e},t},cxform=function(t,a,e,r,i,n,o,s){this.r_add=t,this.g_add=a,this.b_add=e,this.a_add=r,this.r_mult=i,this.g_mult=n,this.b_mult=o,this.a_mult=s,this._cut=function(t,a,e){return t<a&&(t=a),t>e&&(t=e),t},this.apply=function(t){var a=t;return a[0]=this._cut(Math.round(a[0]*this.r_mult/255+this.r_add),0,255),a[1]=this._cut(Math.round(a[1]*this.g_mult/255+this.g_add),0,255),a[2]=this._cut(Math.round(a[2]*this.b_mult/255+this.b_add),0,255),a[3]=this._cut(a[3]*this.a_mult/255+this.a_add/255,0,1),a},this.applyToImage=function(t){if(this.isEmpty())return t;var a=createCanvas(t.w,t.h),e=a.getContext("2d");e.drawImage(t,0,0);for(var r=e.getImageData(0,0,a.w,a.h),i=r.data,n=0;n<i.length;n+=4){var o=this.apply([i[n],i[n+1],i[n+2],i[n+3]/255]);i[n]=o[0],i[n+1]=o[1],i[n+2]=o[2],i[n+3]=Math.round(255*o[3])}return e.putImageData(r,0,0),a},this.merge=function(t){return new cxform(this.r_add+t.r_add,this.g_add+t.g_add,this.b_add+t.b_add,this.a_add+t.a_add,this.r_mult*t.r_mult/255,this.g_mult*t.g_mult/255,this.b_mult*t.b_mult/255,this.a_mult*t.a_mult/255)},this.isEmpty=function(){return 0==this.r_add&&0==this.g_add&&0==this.b_add&&0==this.a_add&&255==this.r_mult&&255==this.g_mult&&255==this.b_mult&&255==this.a_mult}},place=function(t,a,e,r,i,n,o,s,h){if(e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),n>1){var d=e,l=createCanvas(a.w,a.h);e=l.getContext("2d"),enhanceContext(e),e.applyTransforms(d._matrix)}t(e,n>1?new cxform(0,0,0,0,255,255,255,255):i,o,s,h),n>1&&(BlendModes.blendCanvas(i.applyToImage(l),a,a,n),e=d),e.restore()},tocolor=function(t){return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},startWidth=0,startHeight=0,dragWidth=!1,dragHeight=!1,drawMorphPath=function(t,a,e,r,i){var n=a.split(" "),o=n.length;if(r){for(var s=0;s<o;s++)switch(n[s]){case"":break;case"L":case"M":case"Q":break;default:var h=t.applyTransformToPoint({x:n[s],y:n[s+2]});n[s]=h.x,n[s+2]=h.y,h=t.applyTransformToPoint({x:n[s+1],y:n[s+3]}),n[s+1]=h.x,n[s+3]=h.y,s+=3}switch(i){case"NONE":break;case"NORMAL":t.lineWidth*=20*Math.max(t._matrix[0],t._matrix[3]);break;case"VERTICAL":t.lineWidth*=20*t._matrix[3];break;case"HORIZONTAL":t.lineWidth*=20*t._matrix[0]}t.save(),t.setTransform(1,0,0,1,0,0)}t.beginPath();var d="";for(s=0;s<o;s++)switch(n[s]){case"L":case"M":case"Q":d=n[s];break;default:switch(d){case"L":t.lineTo(useRatio(n[s],n[s+1],e),useRatio(n[s+2],n[s+3],e)),s+=3;break;case"M":t.moveTo(useRatio(n[s],n[s+1],e),useRatio(n[s+2],n[s+3],e)),s+=3;break;case"Q":t.quadraticCurveTo(useRatio(n[s],n[s+1],e),useRatio(n[s+2],n[s+3],e),useRatio(n[s+4],n[s+5],e),useRatio(n[s+6],n[s+7],e)),s+=7}}r&&(t.stroke(),t.restore())},useRatio=function(t,a,e){return 1*t+(a-t)*e/65535},drawPath=function(t,a,e,r){var i=a.split(" "),n=i.length;if(e){for(var o=0;o<n;o++)switch(i[o]){case"L":case"M":case"Q":case"Z":break;default:var s=t.applyTransformToPoint({x:i[o],y:i[o+1]});i[o]=s.x,i[o+1]=s.y,o++}switch(r){case"NONE":break;case"NORMAL":t.lineWidth*=20*Math.max(t._matrix[0],t._matrix[3]);break;case"VERTICAL":t.lineWidth*=20*t._matrix[3];break;case"HORIZONTAL":t.lineWidth*=20*t._matrix[0]}t.save(),t.setTransform(1,0,0,1,0,0)}t.beginPath();var h="";for(o=0;o<n;o++)switch(i[o]){case"L":case"M":case"Q":h=i[o];break;case"Z":t.closePath();break;default:switch(h){case"L":t.lineTo(i[o],i[o+1]),o++;break;case"M":t.moveTo(i[o],i[o+1]),o++;break;case"Q":t.quadraticCurveTo(i[o],i[o+1],i[o+2],i[o+3]),o+=3}}e&&(t.stroke(),t.restore())},clamp=(t,a,e)=>Math.max(Math.min(t,e),a),hexToRgb=function(t){var a=parseInt(t,16);return[a>>16&255,a>>8&255,255&a]},shadeColor=function(t,a){t=t||[0,0,0];let e=a[0]/255*2;return a[0]=clamp(t[0]*e,0,255),a[1]=clamp(t[1]*e,0,255),a[2]=clamp(t[2]*e,0,255),a},required={},call=(f,e)=>f(createCanvas,Filters,concatMatrix,enhanceContext,cxform,place,tocolor,drawMorphPath,useRatio,drawPath,e);exports.load=(a,e)=>new Promise((rs,rj)=>(required[a]&&rs(call(required[a],e))||fs.readFile(__dirname+a,'utf8',(err,body)=>{err&&rj(err);required[a]=new Function('createCanvas,Filters,concatMatrix,enhanceContext,cxform,place,tocolor,drawMorphPath,useRatio,drawPath,extra',body);rs(call(required[a],e))})));exports.hexToRgb=hexToRgb;exports.shadeColor=shadeColor;exports.createCanvas=(w,h)=>{let c=crc(w,h),ctx=c.getContext('2d');c.w=w,c.h=h,ctx.fill=fll;return [c,ctx]};exports.isPattern=p=>(p instanceof CanvasPattern);exports.loadImage=loadImage;